# Формат Отчёта о Смене

Этот документ описывает формат текстового отчёта о смене, который бот может распознать и импортировать в `plavka.xlsx`.

## Структура Отчёта

### 1. Заголовок (обязательно)

```
===================================
ОТЧЁТ О СМЕНЕ
===================================
```

### 2. Информация о Смене (обязательные поля)

```
Дата: ДД.ММ.ГГГГ
Смена: Дневная/Ночная
Старший_смены: Фамилия Имя Отчество
Всего плавок: N
```

**Обязательные поля:**
- `Дата` - дата смены в формате ДД.ММ.ГГГГ (например, 06.11.2024)
- `Смена` - название смены (Дневная, Ночная и т.д.)
- `Старший_смены` - ФИО старшего смены
- `Всего плавок` - количество плавок в отчёте (должно совпадать с фактическим)

### 3. Разделитель

```
-----------------------------------
```

### 4. Плавки

Каждая плавка начинается с заголовка `Плавка №` и содержит свои поля:

```
Плавка № 1
Номер: 11-1
Учетный номер: 11-1/24
Наименование отливки: Держатель ригеля
Участник 1: Петров Петр Петрович
Участник 2: Сидоров Сергей Сергеевич
Температура A: 1520.5
Комментарий: Плавка прошла штатно

Плавка № 2
Номер: 11-2
...
```

## Поля Плавки

### Обязательные поля:
- `Номер` - номер плавки (например, 11-1)
- `Наименование отливки` - название изделия

### Рекомендуемые поля:
- `Учетный номер` - учётный номер в формате N-M/YY
- `Участник 1` - ФИО первого участника
- `Участник 2` - ФИО второго участника
- `Участник 3` - ФИО третьего участника
- `Участник 4` - ФИО четвёртого участника

### Опциональные поля:

**Номер кластера:**
- `Номер кластера` - если применимо

**Секторы:**
- `Сектор A` - данные по сектору A
- `Сектор B` - данные по сектору B
- `Сектор C` - данные по сектору C
- `Сектор D` - данные по сектору D

**Времена (сектор A):**
- `Прогрев ковша A` - время прогрева
- `Перемещение A` - время перемещения
- `Заливка A` - время заливки
- `Температура A` - температура заливки (число)

**Времена (сектор B):**
- `Прогрев ковша B`
- `Перемещение B`
- `Заливка B`
- `Температура B`

**Времена (сектор C):**
- `Прогрев ковша C`
- `Перемещение C`
- `Заливка C`
- `Температура C`

**Времена (сектор D):**
- `Прогрев ковша D`
- `Перемещение D`
- `Заливка D`
- `Температура D`

**Прочее:**
- `Тип эксперимента` - если проводился эксперимент
- `Комментарий` - любые дополнительные замечания
- `Время заливки` - общее время заливки

## Полный Пример

```
===================================
ОТЧЁТ О СМЕНЕ
===================================

Дата: 06.11.2024
Смена: Дневная
Старший_смены: Иванов Иван Иванович
Всего плавок: 3

-----------------------------------

Плавка № 1
Номер: 11-1
Учетный номер: 11-1/24
Наименование отливки: Держатель ригеля
Участник 1: Петров Петр Петрович
Участник 2: Сидоров Сергей Сергеевич
Температура A: 1520.5
Комментарий: Плавка прошла штатно

Плавка № 2
Номер: 11-2
Учетный номер: 11-2/24
Наименование отливки: Адаптер
Участник 1: Петров Петр Петрович
Участник 2: Сидоров Сергей Сергеевич
Температура A: 1535.0
Температура B: 1540.0

Плавка № 3
Номер: 11-3
Учетный номер: 11-3/24
Наименование отливки: Вороток
Участник 1: Петров Петр Петрович
Температура A: 1525.0
Комментарий: Небольшая задержка по времени
```

## Как Отправить Отчёт

1. Откройте чат с ботом в Telegram
2. Отправьте команду `/start` (если ещё не делали)
3. Нажмите кнопку **"Добавить запись"**
4. Скопируйте и отправьте текст отчёта (можно из файла .txt)
5. Дождитесь подтверждения от бота

## Ответ Бота при Успехе

```
✅ Отчёт о смене успешно импортирован!

Всего плавок: 3
Записано в Excel: 3
Дата: 06.11.2024
Старший смены: Иванов Иван Иванович
```

## Возможные Ошибки

### "Несоответствие количества плавок"
**Причина:** Количество в поле "Всего плавок" не совпадает с фактическим количеством плавок в тексте.  
**Решение:** Проверьте, все ли плавки указаны, или исправьте число в "Всего плавок".

### "Отсутствует обязательное поле заголовка"
**Причина:** Не указано одно из обязательных полей (Дата, Смена, Старший_смены).  
**Решение:** Добавьте недостающее поле в заголовок отчёта.

### "Пустой отчёт"
**Причина:** Отправлено пустое сообщение или сообщение без данных.  
**Решение:** Проверьте, что текст отчёта был скопирован полностью.

## Советы

1. **Используйте шаблон:** Создайте файл-шаблон и заполняйте его для каждой смены.
2. **Проверяйте формат:** Убедитесь, что используется формат "Поле: Значение" (с двоеточием).
3. **Кириллица:** Все поля могут содержать кириллические символы.
4. **Регистр:** Регистр в названиях полей не важен, но лучше придерживаться одного стиля.
5. **Пустые строки:** Пустые строки между плавками не влияют на парсинг.

## Автоматизация

Для автоматизации создания отчётов можно:
- Использовать скрипты для генерации текста
- Настроить интеграцию с другими системами учёта
- Экспортировать из существующих баз данных

## Проверка Результата

После импорта можно:
1. Нажать **"Последние записи"** - увидеть последние 10 записей
2. Нажать **"Скачать plavka.xlsx"** - скачать полный Excel файл
3. Открыть файл `./Контроль/plavka.xlsx` на сервере

---

**Примечание:** Полный пример отчёта доступен в файле `tests/example_shift_report.txt` в репозитории проекта.
